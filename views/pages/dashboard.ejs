<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0"
        />
        <title>Dashboard</title>
        <link rel="stylesheet" href="/css/styles.css">
        <link rel="stylesheet" href="/css/navbar.css">
        <link rel="stylesheet" href="/css/variables.css">
        <link rel="stylesheet" href="/css/dashboard.css">
        <link rel="stylesheet" href="/css/header.css">
        <link rel="stylesheet" href="/css/classes.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@20,100,0..1,-50" />
    </head>
    <body>
        <%- include('../partials/navbar.ejs', {currentPath}) %>
        <main>
            <%- include("../partials/header.ejs", {pageTitle: 'Dashboard'}) %>
            <div class="dashboard">
                <div class="profile-info">
                    <h2>
                        Edit Your Profile Information
                    </h2>
                    <div class="profile-picture">
                        <div class="current-profile-picture">
                            <img src="<%= user.profile_picture %>" alt="<%= user.ppf_description %>" />
                        </div>
                        <% if(locals.profilePictures) { %>
                            <form class="profile-pictures-container" action="/updated-profile-picture" method="POST">
                                <input type="hidden" name="userId" value="<%= user.id %>" >
                                <% profilePictures.forEach((profilePicture)=>{ %>
                                    <div class="option">
                                        <label for="<%= profilePicture.description %>">
                                            <img style="width: 50px;" src="<%= profilePicture.path %>" alt="<%= profilePicture.description %>" />
                                        </label>
                                        <input type="radio" name="newProfilePicture" id="<%= profilePicture.description %>" value="<%= profilePicture.id %>" />
                                    </div>
                                <% }) %>
                                <button type="submit">
                                    Update Profile Picture
                                </button>
                            </form>
                        <% } %>
                    </div>
                    <form action="/update-user-info" method="POST" class="username">
                        <div class="fullname">
                            <div class="first-name">
                                <label for="first-name">
                                    First Name
                                </label>
                                <div class="input-wrapper">
                                    <span class="material-symbols-sharp">
                                        person
                                    </span>
                                    <input type="text" name="first-name" id="first-name" value="<%= user.first_name %>" />
                                </div>
                            </div>
                            <div class="last-name">
                                <label for="last-name">
                                    Last Name
                                </label>
                                <div class="input-wrapper">
                                    <input type="text" name="last-name" id="last-name" value="<%= user.last_name %>" />
                                </div>
                            </div>
                        </div>
                        <div class="username">
                            <label for="username">
                                Username
                            </label>
                            <div class="input-wrapper">
                                <span class="material-symbols-sharp">
                                    alternate_email
                                </span>
                                <input type="text" name="username" id="username" value="<%= user.username %>">
                            </div>
                        </div>
                        <div class="gender">
                            <div class="male">
                                <label for="male">
                                    Male
                                    <span class="material-symbols-sharp">
                                        male
                                    </span>
                                </label>
                                <input type="radio" name="gender" id="male" value="male" <%= user.gender === 'male'  ? 'checked' : null %>>
                            </div>
                            <div class="female">
                                <label for="female">
                                    Female
                                    <span class="material-symbols-sharp">
                                        female
                                    </span>
                                </label>
                                <input type="radio" name="gender" id="female" value="female" <%= user.gender === 'female'  ? 'checked' : null %>>
                            </div>
                        </div>
                        <div class="bio">
                            <label for="bio">Bio</label>
                            <div class="input-wrapper">
                                <span class="material-symbols-sharp">
                                    person_book
                                </span>
                                <input type="text" name="bio" id="bio" value="<%= user.bio %>">
                            </div>
                        </div>
                        <button type="submit">Update Profile</button>
                    </form>
                </div>
                <div class="password">
                    <h2>Change Your Password</h2>
                    <form action='/update-password' method"POST">
                        <div class="input-container">
                            <label for="originalPassword">
                                Original Password
                            </label>
                            <div class="wrapper">
                                <span class="material-symbols-sharp">
                                    key
                                </span>
                                <input type="text" name="originalPassword" id="originalPassword" />
                            </div>
                        </div>
                        <div class="input-container">
                            <label for="newPassword">
                                New Password
                            </label>
                            <div class="wrapper">
                                <span class="material-symbols-sharp">
                                    key
                                </span>
                                <input type="password" name="newPassword" id="newPassword" />
                            </div>
                        </div>
                        <div class="input-container">
                            <label for="confirmNewPassword">
                                Confirm New Password
                            </label>
                            <div class="wrapper">
                                <span class="material-symbols-sharp">
                                    key
                                </span>
                                <input type="password" name="confirmNewPassword" id="confirmNewPassword" />
                            </div>
                        </div>
                        <button class="form-button" type="submit">
                            Change Password
                        </button>
                    </form>
                </div>
                <div class="badges">
                    <h2>Account Privileges</h2>
                    <% if(user.is_admin) { %>
                        <span class="material-symbols-sharp">
                            local_police
                        </span>
                    <% } else { %>
                        <span class="material-symbols-sharp">
                            block
                        </span>
                        <span class="material-symbols-sharp">
                            local_police
                        </span>
                    <% } %>
                    <% if(user.is_member) { %>
                        <span class="material-symbols-sharp">
                            award_star
                        </span>
                    <% } else { %>
                        <span class="material-symbols-sharp">
                            block
                        </span>
                        <span class="material-symbols-sharp">
                            award_star
                        </span>
                    <% } %>
                    <% if(!user.is_member){ %>
                        <form action="/member-pass" method="POST">
                            <label for="memberPass">
                                Enable member status:
                                <input type="password" name="memberPass" id="memberPass" />
                            </label>
                            <button type="submit">
                                Enable member status
                            </button>
                        </form>
                    <% } %>
                    <% if(!user.is_admin) { %>
                        <form action="/admin-pass" method="POST">
                            <label for="adminPass">
                                Enable admin status:
                                <input type="password" name="adminPass" id="adminPass" />
                                <button type="submit">
                                    Enable admin status
                                </button>
                            </label>
                        </form>
                    <% } %>
                    <form action="/delete-user" method="POST">
                        <label for="deleteUserPass">
                            Enter your password to confirm the deletion
                            <input type="password" name="deleteUserPass" id="deleteUserPass" />
                        </label>
                        <button type="submit">
                            Delete Your Account
                        </button>
                    </form>
                </div>
                <div class="svg"></div>
                <div class="user-messages">
                    <h2>All The Messages You Send</h2>
                    Messages created by the user.
                </div>
                <% if(locals.validationErrors) { %>
                    <div class="validation-errors">
                        <% validationErrors.forEach((error)=>{ %>
                            <p>
                                <%= error.msg %>
                            </p>
                        <% }) %>
                    </div>
                <% } %>
            </div>
        </main>
    </body>
</html>
